<div class="test-container">
  <c-container>
    <h2 class="text-center">
      {{
        examService.currentExamCurriculumID == "1"
          ? "Online Citizenship Test"
          : "Online Driving License Test"
      }}
    </h2>
    @if(!this.examService.isPracticeModeON &&
    this.examService.isExamStarted.value == false) {
    <h2 class="text-center">
      @if(examLoaded) {
      <button
        cButton
        class="btn-start-exam"
        color="danger"
        shape="rounded"
        (click)="onClickExamStart()"
      >
        Start Exam
      </button>
      } @else {
      <div class="d-flex justify-content-center align-items-center">
        <c-spinner color="danger"></c-spinner>
      </div>
      }
    </h2>
    }
    <h3 class="test-name">
      {{ getExamName() }}
    </h3>
    @if(this.examService.isExamFinished.value == true) {
    <div
      [ngClass]="{
        'result-summary-pass': this.isPassed,
        'result-summary-fail': !this.isPassed
      }"
    >
      <c-card>
        <c-card-body>
          <h3>Your Result</h3>
          <h4>Result: {{ this.isPassed ? "Passed" : "Failed" }}</h4>
          <h4>
            Correct Answers: {{ this.correctCount }} out of
            {{ this.questionCount }}
          </h4>
          <h4>
            Score: {{ getPercentage(this.correctCount, this.questionCount) }} %
          </h4>
          <h4>
            {{
              this.isPassed
                ? "Congratulations! Keep it up."
                : "Please keep practicing."
            }}
          </h4>
        </c-card-body>
      </c-card>
    </div>
    } @if(examLoaded) {
    <c-row
      [gutter]="4"
      [ngClass]="{
        blur:
          !this.examService.isPracticeModeON &&
          this.examService.isExamStarted.value == false
      }"
    >
      <c-col
        [lg]="
          this.examService.isPracticeModeON &&
          this.examService.isExamFinished.value == false
            ? 10
            : 8
        "
        [offset]="
          this.examService.isPracticeModeON &&
          this.examService.isExamFinished.value == false
            ? 1
            : 0
        "
      >
        <app-question
          #questionComponent
          [questionIndex]="currentQuestionIndex"
          [totalQuestions]="questionCount"
          [question]="questions[currentQuestionIndex]"
          (questionAnsweredEvent)="onQuestionAnswered($event)"
          (questionNavigationEvent)="onQuestionNavigation($event)"
        />
      </c-col>
      @if(!this.examService.isPracticeModeON ||
      this.examService.isExamFinished.value == true) {
      <c-col lg="4">
        <app-question-number-grid
          [timeLeft]="timeLeft"
          [totalQuestions]="questionCount"
          [answeredCount]="this.examService.answeredCount"
          [notAnsweredCount]="notAnsweredCount"
          [passMarkPercentage]="passMarkPercentage"
          [allowedMistakesCount]="allowedMistakesCount"
          [examTimeInMinutes]="examTimeInMinutes"
          [currentQuestionIndex]="currentQuestionIndex"
          (questionNumberClickedEvent)="onQuestionNumberClicked($event)"
        />
      </c-col>
      }
    </c-row>
    }
  </c-container>
</div>
